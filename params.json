{"name":"Squid2radius","tagline":"Analyzes your squid access.log file, and reports accounting information (data transfer) to a RADIUS server","body":"squid2radius\r\n============\r\n\r\nsquid2radius analyzes your squid `access.log` file, and reports usage information to a RADIUS server using `Accounting-Request` as defined in RFC 2866.\r\n\r\nAfter analyzing is finished, it calls squid to rotate your log file so that no lines will be counted more than once.\r\n\r\nInstallation\r\n------------\r\n\r\n### Clone Git repo\r\n\r\n```bash\r\ngit clone git://github.com/jiehanzheng/squid2radius.git\r\n```\r\n\r\n### Install dependencies\r\n\r\n```bash\r\n# install pip for python2, command varies if you are on a different OS\r\nsudo pacman -S python2-pip\r\n\r\n# install pyrad, command varies if you are on a different OS\r\nsudo pip2 install pyrad hurry.filesize\r\n```\r\n\r\nUpgrading to v1.0\r\n-----------------\r\n\r\n### New dependency `hurry.filesize`\r\n\r\nNote that an dependency `hurry.filesize` is required since Version 1.0.  Run \r\n`sudo pip2 install hurry.filesize` to install it.\r\n\r\n\r\nUsage\r\n-----\r\n\r\n```\r\nusage: squid2radius.py [-h] [--version] [-p RADIUS_ACCT_PORT]\r\n                       [--radius-nasid RADIUS_NASID] [--squid-path SQUID_PATH]\r\n                       [--exclude-pattern EXCLUDE_PATTERN] [--dry-run]\r\n                       [--no-rotation]\r\n                       logfile_path radius_server radius_secret\r\n```\r\n\r\nFor instance, run like this if you have access log file at `/var/log/squid/access.log`, RADIUS server running at `localhost` with secret set to `testing123`:\r\n\r\n```bash\r\nsudo python2 squid2radius.py /var/log/squid/access.log localhost testing123\r\n```\r\n\r\nIt is certainly a good idea to make a cron job for this.\r\n\r\nYou should also read [SquidFaq/SquidLogs](http://wiki.squid-cache.org/SquidFaq/SquidLogs#access.log) to make sure your log files are in reasonable sizes.\r\n\r\n### --exclude-pattern\r\n\r\nIf for some reason you need to prevent usage information of certain user from being sent to the RADIUS server, there is an argument for that!  Use `--exclude-pattern=\"(girl|boy)friend\"` and squid2radius won't send usage of either your `girlfriend` or `boyfriend` to the RADIUS server.\r\n\r\n### --dry-run\r\n\r\nIf the script is called with this argument, no data will be sent to the server.\r\n\r\n### --no-rotation\r\n\r\nBy default squid2radius calls `squid -k rotate` to make squid rotate your log files right after we are done counting usage data, in order to ensure usage data accuracy by not counting any log lines more than once next time you run it.  If this is troublesome in your setup, you can add `--no-rotation` argument to disable this behavior.\r\n\r\nNote\r\n----\r\n\r\nThe script assumes that you are using the default [Squid native access.log format](http://wiki.squid-cache.org/Features/LogFormat#squid) on first ten columns of your log file.  If you need custom columns, add them after the default ones.\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}